let JS;
if (1) {
    JS = `{"size":15,"blank":[8,9,16,18,20,22,24,26,28,39,46,48,50,52,54,56,58,65,75,76,78,80,82,83,84,85,86,88,89,95,97,106,107,108,110,112,114,116,117,118,127,129,135,136,138,139,140,141,142,144,146,148,149,159,166,168,170,172,174,176,178,185,196,198,200,202,204,206,208,215,216],"numbers":{"0":1,"2":2,"4":3,"6":4,"10":5,"12":6,"14":7,"23":8,"30":9,"40":10,"60":11,"66":12,"90":13,"98":14,"100":15,"104":16,"120":17,"122":18,"130":19,"132":20,"150":21,"154":22,"156":23,"160":24,"164":25,"180":26,"186":27,"210":28,"217":29},"across":{"1":{"clue":"Get a hold of yourself, ugly great pig! (3,1,4)","answer":"GETAGRIP"},"5":{"clue":"Dig endlessly following gold before first ounce can be heard (5)","answer":"AUDIO"},"9":{"clue":"The spineless dear tends to drift, completely soullessly, around untruths most lethal (9)","answer":"DEADLIEST"},"10":{"clue":"Messy apron to be expected (2,3)","answer":"ONPAR"},"11":{"clue":"He is found in firstly orchestral techno radio, not this one (5)","answer":"OTHER"},"12":{"clue":"Spot the spanish bat fly back (surfaces) (9)","answer":"TABLETOPS"},"13":{"clue":"Pole upon nobleman (5)","answer":"BARON"},"14":{"clue":"Get around to Sierra, who holds ABBA single 'Leaf pouch'? (7)","answer":"TEABAGS"},"17":{"clue":"Salt found in sea is all reversed for maps (7)","answer":"ATLASES"},"19":{"clue":"Brief roleplay about returning a card (5)","answer":"RECAP"},"21":{"clue":"Owning painlessly after Illumination strikes (9)","answer":"LIGHTNING"},"24":{"clue":"UNICEF splits to surround greeting for leader (5)","answer":"CHIEF"},"26":{"clue":"1L 51 3 (no evens) (5)","answer":"LITRE"},"27":{"clue":"Hair from head to toe before jockey gets decapitated for an arcade game (3,6)","answer":"AIRHOCKEY"},"28":{"clue":"Birthday messages are hard without help at first in computer science (5)","answer":"CARDS"},"29":{"clue":"Tacks on awkward nods between 1st avenue drug trade and seventh interrogation (4,2,2)","answer":"ADDSONTO"}},"down":{"1":{"clue":"Absolutely not. Go back on about delta (3,2)","answer":"GODNO"},"2":{"clue":"Audible T-100 (one hundred) seconds before crying to lecturer (7)","answer":"TEACHER"},"3":{"clue":"Go with first low detail resolution image (not green-screened) to make famous Christmas five (4,5)","answer":"GOLDRINGS"},"4":{"clue":"Toss crime, toss freezing rain (3,6)","answer":"ICESTORMS"},"5":{"clue":"We hear a gateway to make love (5)","answer":"ADORE"},"6":{"clue":"Initially leave observent men amazed after lower point a degree (7)","answer":"DIPLOMA"},"7":{"clue":"Goes half backwards (retreats joylessly) to trolls (5)","answer":"OGRES"},"8":{"clue":"Pierce bat's back (4)","answer":"STAB"},"13":{"clue":"Take boar's spine for snake (3)","answer":"BOA"},"14":{"clue":"Annoyed, regret dig badly (9)","answer":"TRIGGERED"},"15":{"clue":"Our taco is messy, terrible. (9)","answer":"ATROCIOUS"},"16":{"clue":"Juice from Sp a in (3)","answer":"SAP"},"18":{"clue":"Firestarter weighs less? (7)","answer":"LIGHTER"},"20":{"clue":"Wimp meat? (7)","answer":"CHICKEN"},"21":{"clue":"Small air conditioning unit's rapper name is colourful (5)","answer":"LILAC"},"22":{"clue":"Plants look back after first traitor ratted (5)","answer":"TREES"},"23":{"clue":"IP address contains a device (4)","answer":"IPAD"},"25":{"clue":"Catch a flight to first forensics lecture - tragically opens revolving around why we hear (3,2)","answer":"FLYTO"}},"ref":{"0":["1a","1d"],"1":["1a"],"2":["1a","2d"],"3":["1a"],"4":["1a","3d"],"5":["1a"],"6":["1a","4d"],"7":["1a"],"15":["1d"],"30":["1d","9a"],"45":["1d"],"60":["1d","11a"],"17":["2d"],"32":["2d","9a"],"47":["2d"],"62":["2d","11a"],"77":["2d"],"92":["2d","13a"],"19":["3d"],"34":["3d","9a"],"49":["3d"],"64":["3d","11a"],"79":["3d"],"94":["3d","13a"],"109":["3d"],"124":["3d","17a"],"21":["4d"],"36":["4d","9a"],"51":["4d"],"66":["4d","12a"],"81":["4d"],"96":["4d"],"111":["4d"],"126":["4d","17a"],"10":["5a","5d"],"11":["5a"],"12":["5a","6d"],"13":["5a"],"14":["5a","7d"],"25":["5d"],"40":["5d","10a"],"55":["5d"],"70":["5d","12a"],"27":["6d"],"42":["6d","10a"],"57":["6d"],"72":["6d","12a"],"87":["6d"],"102":["6d","14a"],"29":["7d"],"44":["7d","10a"],"59":["7d"],"74":["7d","12a"],"23":["8d"],"38":["8d","9a"],"53":["8d"],"68":["8d","12a"],"31":["9a"],"33":["9a"],"35":["9a"],"37":["9a"],"41":["10a"],"43":["10a"],"61":["11a"],"63":["11a"],"67":["12a"],"69":["12a"],"71":["12a"],"73":["12a"],"90":["13a","13d"],"91":["13a"],"93":["13a"],"105":["13d"],"120":["13d","17a"],"98":["14a","14d"],"99":["14a"],"100":["14a","15d"],"101":["14a"],"103":["14a"],"104":["14a","16d"],"113":["14d"],"128":["14d"],"143":["14d"],"158":["14d","21a"],"173":["14d"],"188":["14d","27a"],"203":["14d"],"218":["14d","29a"],"115":["15d"],"130":["15d","19a"],"145":["15d"],"160":["15d","24a"],"175":["15d"],"190":["15d","27a"],"205":["15d"],"220":["15d","29a"],"119":["16d"],"134":["16d","19a"],"121":["17a"],"122":["17a","18d"],"123":["17a"],"125":["17a"],"137":["18d"],"152":["18d","21a"],"167":["18d"],"182":["18d","26a"],"197":["18d"],"212":["18d","28a"],"131":["19a"],"132":["19a","20d"],"133":["19a"],"147":["20d"],"162":["20d","24a"],"177":["20d"],"192":["20d","27a"],"207":["20d"],"222":["20d","29a"],"150":["21a","21d"],"151":["21a"],"153":["21a"],"154":["21a","22d"],"155":["21a"],"156":["21a","23d"],"157":["21a"],"165":["21d"],"180":["21d","26a"],"195":["21d"],"210":["21d","28a"],"169":["22d"],"184":["22d","26a"],"199":["22d"],"214":["22d","28a"],"171":["23d"],"186":["23d","27a"],"201":["23d"],"161":["24a"],"163":["24a"],"164":["24a","25d"],"179":["25d"],"194":["25d","27a"],"209":["25d"],"224":["25d","29a"],"181":["26a"],"183":["26a"],"187":["27a"],"189":["27a"],"191":["27a"],"193":["27a"],"211":["28a"],"213":["28a"],"217":["29a"],"219":["29a"],"221":["29a"],"223":["29a"]}}`;
}

let clue_ends = {};
const TILE_SIZE = 32;

function load() {
    return JSON.parse(JS);
}

let board = load();
for (let [num, info] of Object.entries(board.across)) {
    add_clue(num, info.clue, "across");
    let or = get_origin(`${num}a`);
    let x = or[0] + info.answer.length - 1;
    let y = or[1];
    clue_ends[`${num}a`] = `${y * board.size + x};${x};${y}`;
}

for (let [num, info] of Object.entries(board.down)) {
    add_clue(num, info.clue, "down");
    let or = get_origin(`${num}d`);
    let x = or[0];
    let y = or[1] + info.answer.length - 1;
    clue_ends[`${num}d`] = `${y * board.size + x};${x};${y}`;
}

function get_origin(clue) {
    let num = clue.slice(0, clue.length - 1);
    for (let number of Object.keys(board.numbers)) {
        if (board.numbers[number] == num) return [number % board.size, Math.floor(number / board.size)];
    }
}

function create_board() {
    function create_square(x, y) {
        let i = y * board.size + x;

        let num;
        if (board.numbers[i]) num = board.numbers[i];
        
        
        if (board.blank.includes(i)) {
            let el = document.createElement("div");
            el.className = "blank";
            el.style.left = `${(x + 1) * TILE_SIZE}px`;
            el.style.top = `${(y + 1) * TILE_SIZE}px`;
            document.body.appendChild(el);
        } else {
            if (num) {
                let n = document.createElement("p");
                n.className = "number";
                n.style.left = `${(x + 1) * TILE_SIZE}px`;
                n.style.top = `${(y + 1) * TILE_SIZE}px`;
                n.innerText = num;
                document.body.appendChild(n);
            }

            let el = document.createElement("div");
            el.className = "square";
            el.style.left = `${(x + 1) * TILE_SIZE}px`;
            el.style.top = `${(y + 1) * TILE_SIZE}px`;
            el.id = `${i};${x};${y}`;

            if (x == 0) el.classList.add("left_exposed");
            if (y == 0) el.classList.add("top_exposed");

            document.body.appendChild(el);
        }
    }

    for (y = 0; y < board.size; y++) {
        for (x = 0; x < board.size; x++) {
            create_square(x, y);
        }
    }
}

create_board();
main();

function add_clue(num, clue, dir) {
    let li = document.createElement("li");
    li.className = "clue";
    li.id = `${num}${dir.charAt(0)}`;
    li.innerText = `${num}: ${clue}`;
    li.onclick = ev => {
        let e = ev.target;
        let n = e.id.slice(0, e.id.length - 1);
        let d = e.id.charAt(e.id.length - 1);

        let dir = d == "d" ? "down" : "across";
        let [x, y] = get_origin(`${n}${d}`);

        selected = document.getElementById(`${y * board.size + x};${x};${y}`);
        selected_dir = d;
        update_selection();
    }
    
    document.getElementById(dir).appendChild(li);
}
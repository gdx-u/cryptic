let JS;
if (1) {
    JS = `{"size":15,"blank":[9,16,18,20,22,24,26,28,37,46,48,50,52,54,56,58,64,65,69,70,75,76,78,79,80,82,84,85,86,88,97,106,107,108,110,111,112,113,114,116,117,118,127,136,138,139,140,142,144,145,146,148,149,154,155,159,160,166,168,170,172,174,176,178,187,196,198,200,202,204,206,208,215],"numbers":{"0":1,"2":2,"4":3,"6":4,"8":5,"10":6,"12":7,"14":8,"30":9,"38":10,"60":11,"66":12,"71":13,"90":14,"94":15,"98":16,"100":17,"120":18,"122":19,"126":20,"128":21,"132":22,"150":23,"156":24,"161":25,"164":26,"169":27,"175":28,"180":29,"188":30,"210":31,"216":32},"across":{"1":{"clue":"Leaving, you get a notification sound after second echo not found in spreadsheet software (9)","answer":"EXCLUDING"},"6":{"clue":"66,500 clear (5)","answer":"VIVID"},"9":{"clue":"Follow win? (7)","answer":"SUCCEED"},"10":{"clue":"Air conditioning in Burger King broken? Leave. (4,3)","answer":"BACKOFF"},"11":{"clue":"On golf after 50 - that's a stretch (4)","answer":"LONG"},"12":{"clue":"Pressure when private investigator surrounds first suspect (3, abbr.)","answer":"PSI"},"13":{"clue":"'Hear hear' location (4)","answer":"HERE"},"14":{"clue":"Sift around in broken air conditioning unit before hotel makes use of someone else's photo (7)","answer":"CATFISH"},"16":{"clue":"Genius' sweet? (7)","answer":"SMARTIE"},"18":{"clue":"Decapitated bear found in new york laying before heartless sour local (4,3)","answer":"NEARYOU"},"21":{"clue":"Okay young woman is sent back into a harsh tongued primary (7)","answer":"ALRIGHT"},"23":{"clue":"Mother in 9 cinema (4)","answer":"IMAX"},"24":{"clue":"Hide and seek call audibly leads to hospital wing (3, abbr.)","answer":"ICU"},"25":{"clue":"Spineless rat found in heartless team vehicle (4)","answer":"TRAM"},"29":{"clue":"Ocado is chasing a 5 for fruit (7)","answer":"AVOCADO"},"30":{"clue":"Preferably thought before taking 50/50 just before the start of the year (7)","answer":"IDEALLY"},"31":{"clue":"Country extra terrestrial hugs flipping possessionless pygmy (5)","answer":"EGYPT"},"32":{"clue":"Might near awkward dream (9)","answer":"NIGHTMARE"}},"down":{"1":{"clue":"Return lease, as swapping for canvas (5)","answer":"EASEL"},"2":{"clue":"Fruit scam in pointless count (7)","answer":"COCONUT"},"3":{"clue":"Be in (partially) your taxi (4)","answer":"UBER"},"4":{"clue":"High level of detail in 'Supermind' ep. three (2,5)","answer":"INDEPTH"},"5":{"clue":"Dwarfs crazy lingo bs (7)","answer":"GOBLINS"},"6":{"clue":"Deputy weakness? (4)","answer":"VICE"},"7":{"clue":"Angry, not initially in colour (7)","answer":"VIOLENT"},"8":{"clue":"Other fifteen, Dr Strange. (9)","answer":"DIFFERENT"},"14":{"clue":"Volunteer for age after one hundred and one (9)","answer":"CANDIDATE"},"15":{"clue":"I see why we listen to frozen (3)","answer":"ICY"},"17":{"clue":"Lair releases fifty gases (3)","answer":"AIR"},"19":{"clue":"Particle in any study of biological structure (7)","answer":"ANATOMY"},"20":{"clue":"Building of higher education initially created only regarding neuroscience for mythical animal (7)","answer":"UNICORN"},"21":{"clue":"Bullying a bug to embrace wrongdoing (7)","answer":"ABUSING"},"22":{"clue":"An ape is all i traced back after uninspired gore (7)","answer":"GORILLA"},"26":{"clue":"Month flier, perchance? (5)","answer":"MAYBE"},"27":{"clue":"Personal trainer works around broken arm segment (4)","answer":"PART"},"28":{"clue":"Shirt in five stores (4)","answer":"VEST"}},"ref":{"0":["1a","1d"],"1":["1a"],"2":["1a","2d"],"3":["1a"],"4":["1a","3d"],"5":["1a"],"6":["1a","4d"],"7":["1a"],"8":["1a","5d"],"15":["1d"],"30":["1d","9a"],"45":["1d"],"60":["1d","11a"],"17":["2d"],"32":["2d","9a"],"47":["2d"],"62":["2d","11a"],"77":["2d"],"92":["2d","14a"],"19":["3d"],"34":["3d","9a"],"49":["3d"],"21":["4d"],"36":["4d","9a"],"51":["4d"],"66":["4d","12a"],"81":["4d"],"96":["4d","14a"],"23":["5d"],"38":["5d","10a"],"53":["5d"],"68":["5d","12a"],"83":["5d"],"98":["5d","16a"],"10":["6a","6d"],"11":["6a"],"12":["6a","7d"],"13":["6a"],"14":["6a","8d"],"25":["6d"],"40":["6d","10a"],"55":["6d"],"27":["7d"],"42":["7d","10a"],"57":["7d"],"72":["7d","13a"],"87":["7d"],"102":["7d","16a"],"29":["8d"],"44":["8d","10a"],"59":["8d"],"74":["8d","13a"],"89":["8d"],"104":["8d","16a"],"119":["8d"],"134":["8d","21a"],"31":["9a"],"33":["9a"],"35":["9a"],"39":["10a"],"41":["10a"],"43":["10a"],"61":["11a"],"63":["11a"],"67":["12a"],"71":["13a"],"73":["13a"],"90":["14a","14d"],"91":["14a"],"93":["14a"],"94":["14a","15d"],"95":["14a"],"105":["14d"],"120":["14d","18a"],"135":["14d"],"150":["14d","23a"],"165":["14d"],"180":["14d","29a"],"195":["14d"],"210":["14d","31a"],"109":["15d"],"124":["15d","18a"],"99":["16a"],"100":["16a","17d"],"101":["16a"],"103":["16a"],"115":["17d"],"130":["17d","21a"],"121":["18a"],"122":["18a","19d"],"123":["18a"],"125":["18a"],"126":["18a","20d"],"137":["19d"],"152":["19d","23a"],"167":["19d"],"182":["19d","29a"],"197":["19d"],"212":["19d","31a"],"141":["20d"],"156":["20d","24a"],"171":["20d"],"186":["20d","29a"],"201":["20d"],"216":["20d","32a"],"128":["21a","21d"],"129":["21a"],"131":["21a"],"132":["21a","22d"],"133":["21a"],"143":["21d"],"158":["21d","24a"],"173":["21d"],"188":["21d","30a"],"203":["21d"],"218":["21d","32a"],"147":["22d"],"162":["22d","25a"],"177":["22d"],"192":["22d","30a"],"207":["22d"],"222":["22d","32a"],"151":["23a"],"153":["23a"],"157":["24a"],"161":["25a"],"163":["25a"],"164":["25a","26d"],"179":["26d"],"194":["26d","30a"],"209":["26d"],"224":["26d","32a"],"169":["27d"],"184":["27d","29a"],"199":["27d"],"214":["27d","31a"],"175":["28d"],"190":["28d","30a"],"205":["28d"],"220":["28d","32a"],"181":["29a"],"183":["29a"],"185":["29a"],"189":["30a"],"191":["30a"],"193":["30a"],"211":["31a"],"213":["31a"],"217":["32a"],"219":["32a"],"221":["32a"],"223":["32a"]}}`;
}

let clue_ends = {};
const TILE_SIZE = 32;

function load() {
    return JSON.parse(JS);
}

let board = load();
for (let [num, info] of Object.entries(board.across)) {
    add_clue(num, info.clue, "across");
    let or = get_origin(`${num}a`);
    let x = or[0] + info.answer.length - 1;
    let y = or[1];
    clue_ends[`${num}a`] = `${y * board.size + x};${x};${y}`;
}

for (let [num, info] of Object.entries(board.down)) {
    add_clue(num, info.clue, "down");
    let or = get_origin(`${num}d`);
    let x = or[0];
    let y = or[1] + info.answer.length - 1;
    clue_ends[`${num}d`] = `${y * board.size + x};${x};${y}`;
}

function get_origin(clue) {
    let num = clue.slice(0, clue.length - 1);
    for (let number of Object.keys(board.numbers)) {
        if (board.numbers[number] == num) return [number % board.size, Math.floor(number / board.size)];
    }
}

function create_board() {
    function create_square(x, y) {
        let i = y * board.size + x;

        let num;
        if (board.numbers[i]) num = board.numbers[i];
        
        
        if (board.blank.includes(i)) {
            let el = document.createElement("div");
            el.className = "blank";
            el.style.left = `${(x + 1) * TILE_SIZE}px`;
            el.style.top = `${(y + 1) * TILE_SIZE}px`;
            document.body.appendChild(el);
        } else {
            if (num) {
                let n = document.createElement("p");
                n.className = "number";
                n.style.left = `${(x + 1) * TILE_SIZE}px`;
                n.style.top = `${(y + 1) * TILE_SIZE}px`;
                n.innerText = num;
                document.body.appendChild(n);
            }

            let el = document.createElement("div");
            el.className = "square";
            el.style.left = `${(x + 1) * TILE_SIZE}px`;
            el.style.top = `${(y + 1) * TILE_SIZE}px`;
            el.id = `${i};${x};${y}`;

            if (x == 0) el.classList.add("left_exposed");
            if (y == 0) el.classList.add("top_exposed");

            document.body.appendChild(el);
        }
    }

    for (y = 0; y < board.size; y++) {
        for (x = 0; x < board.size; x++) {
            create_square(x, y);
        }
    }
}

create_board();
main();

function add_clue(num, clue, dir) {
    let li = document.createElement("li");
    li.className = "clue";
    li.id = `${num}${dir.charAt(0)}`;
    li.innerText = `${num}: ${clue}`;
    li.onclick = ev => {
        let e = ev.target;
        let n = e.id.slice(0, e.id.length - 1);
        let d = e.id.charAt(e.id.length - 1);

        let dir = d == "d" ? "down" : "across";
        let [x, y] = get_origin(`${n}${d}`);

        selected = document.getElementById(`${y * board.size + x};${x};${y}`);
        selected_dir = d;
        update_selection();
    }
    
    document.getElementById(dir).appendChild(li);
}
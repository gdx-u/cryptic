let JS;
if (1) {
    JS = `{"size":15,"blank":[7,16,18,20,22,24,26,28,37,46,48,50,52,54,56,58,65,75,76,78,80,82,83,84,85,86,88,95,106,107,108,110,112,114,116,117,118,129,136,138,139,140,141,142,144,146,148,149,159,166,168,170,172,174,176,178,187,196,198,200,202,204,206,208,217],"numbers":{"0":1,"2":2,"4":3,"6":4,"8":5,"10":6,"12":7,"14":8,"30":9,"38":10,"60":11,"66":12,"90":13,"96":14,"98":15,"100":16,"120":17,"122":18,"130":19,"132":20,"150":21,"154":22,"156":23,"160":24,"164":25,"180":26,"188":27,"210":28,"218":29},"across":{"1":{"clue":"Convey fast? (7)","answer":"EXPRESS"},"5":{"clue":"Hand over flash drive to ex-groom (7)","answer":"HUSBAND"},"9":{"clue":"Beret stripped after wave 100 gets real (7)","answer":"SINCERE"},"10":{"clue":"Two surround ryan after bee audibly makes Indian rice dish (7)","answer":"BIRYANI"},"11":{"clue":"Beef musical? (5)","answer":"DRAMA"},"12":{"clue":"Swap title for brand's identity (5,4)","answer":"TRADENAME"},"13":{"clue":"Grab iron, technetium and hydrogen (5)","answer":"FETCH"},"14":{"clue":"Heartless themes before dairy painting by Edvard (3,6)","answer":"THESCREAM"},"17":{"clue":"Weak first tennis hit ice cream (4,5)","answer":"SOFTSERVE"},"19":{"clue":"Advertisement about global conflict gets a prize (5)","answer":"AWARD"},"21":{"clue":"Seeing from taking pictures outside-in (9)","answer":"IMAGINING"},"24":{"clue":"Cubed two weight without tungsten (5)","answer":"EIGHT"},"26":{"clue":"The news? (7)","answer":"ARTICLE"},"27":{"clue":"Stripped, ashen, Romeo gambles endlessly for sweet powder (7)","answer":"SHERBET"},"28":{"clue":"Dirty a murder canal's end (7)","answer":"EARDRUM"},"29":{"clue":"Prosecutes around agreement for desserts (7)","answer":"SUNDAES"}},"down":{"1":{"clue":"Assisted in areas edge (5)","answer":"EASED"},"2":{"clue":"Charm secrecy pact in one half of the pentagon (7)","answer":"PENDANT"},"3":{"clue":"Body hairs from 50 ashes after I become audible (9)","answer":"EYELASHES"},"4":{"clue":"Spin endlessly backwards after half-speckled observer (9)","answer":"SPECTATOR"},"5":{"clue":"Community center takes degree, a pre-bubba mouthful (5)","answer":"HUBBA"},"6":{"clue":"Wait on reversing electric vehicle after user becomes headless (5)","answer":"SERVE"},"7":{"clue":"High profile release from battery before match (3,4)","answer":"AAAGAME"},"8":{"clue":"Made angry, flip, damn, after ride (6,3)","answer":"DRIVENMAD"},"13":{"clue":"Fascist loses 14 pounds to native, which lost 4 to amaze (9)","answer":"FASCINATE"},"15":{"clue":"Amps up singer, messed up in backwards glance (9)","answer":"ENERGISES"},"16":{"clue":"Lizard hotel in California gains energy-infused melon (9)","answer":"CHAMELEON"},"18":{"clue":"Big up coffee in francium (7)","answer":"FLATTER"},"20":{"clue":"Confusedly grab ale for subject (7)","answer":"ALGEBRA"},"22":{"clue":"Acquire debt from within origin currency (5)","answer":"INCUR"},"23":{"clue":"End of intestine one with 50 serum ripped senior (5)","answer":"ILEUM"},"25":{"clue":"Bags, totally colloquially? (5)","answer":"TOTES"}},"ref":{"0":["1a","1d"],"1":["1a"],"2":["1a","2d"],"3":["1a"],"4":["1a","3d"],"5":["1a"],"6":["1a","4d"],"15":["1d"],"30":["1d","9a"],"45":["1d"],"60":["1d","11a"],"17":["2d"],"32":["2d","9a"],"47":["2d"],"62":["2d","11a"],"77":["2d"],"92":["2d","13a"],"19":["3d"],"34":["3d","9a"],"49":["3d"],"64":["3d","11a"],"79":["3d"],"94":["3d","13a"],"109":["3d"],"124":["3d","17a"],"21":["4d"],"36":["4d","9a"],"51":["4d"],"66":["4d","12a"],"81":["4d"],"96":["4d","14a"],"111":["4d"],"126":["4d","17a"],"8":["5a","5d"],"9":["5a"],"10":["5a","6d"],"11":["5a"],"12":["5a","7d"],"13":["5a"],"14":["5a","8d"],"23":["5d"],"38":["5d","10a"],"53":["5d"],"68":["5d","12a"],"25":["6d"],"40":["6d","10a"],"55":["6d"],"70":["6d","12a"],"27":["7d"],"42":["7d","10a"],"57":["7d"],"72":["7d","12a"],"87":["7d"],"102":["7d","14a"],"29":["8d"],"44":["8d","10a"],"59":["8d"],"74":["8d","12a"],"89":["8d"],"104":["8d","14a"],"119":["8d"],"134":["8d","19a"],"31":["9a"],"33":["9a"],"35":["9a"],"39":["10a"],"41":["10a"],"43":["10a"],"61":["11a"],"63":["11a"],"67":["12a"],"69":["12a"],"71":["12a"],"73":["12a"],"90":["13a","13d"],"91":["13a"],"93":["13a"],"105":["13d"],"120":["13d","17a"],"135":["13d"],"150":["13d","21a"],"165":["13d"],"180":["13d","26a"],"195":["13d"],"210":["13d","28a"],"97":["14a"],"98":["14a","15d"],"99":["14a"],"100":["14a","16d"],"101":["14a"],"103":["14a"],"113":["15d"],"128":["15d","17a"],"143":["15d"],"158":["15d","21a"],"173":["15d"],"188":["15d","27a"],"203":["15d"],"218":["15d","29a"],"115":["16d"],"130":["16d","19a"],"145":["16d"],"160":["16d","24a"],"175":["16d"],"190":["16d","27a"],"205":["16d"],"220":["16d","29a"],"121":["17a"],"122":["17a","18d"],"123":["17a"],"125":["17a"],"127":["17a"],"137":["18d"],"152":["18d","21a"],"167":["18d"],"182":["18d","26a"],"197":["18d"],"212":["18d","28a"],"131":["19a"],"132":["19a","20d"],"133":["19a"],"147":["20d"],"162":["20d","24a"],"177":["20d"],"192":["20d","27a"],"207":["20d"],"222":["20d","29a"],"151":["21a"],"153":["21a"],"154":["21a","22d"],"155":["21a"],"156":["21a","23d"],"157":["21a"],"169":["22d"],"184":["22d","26a"],"199":["22d"],"214":["22d","28a"],"171":["23d"],"186":["23d","26a"],"201":["23d"],"216":["23d","28a"],"161":["24a"],"163":["24a"],"164":["24a","25d"],"179":["25d"],"194":["25d","27a"],"209":["25d"],"224":["25d","29a"],"181":["26a"],"183":["26a"],"185":["26a"],"189":["27a"],"191":["27a"],"193":["27a"],"211":["28a"],"213":["28a"],"215":["28a"],"219":["29a"],"221":["29a"],"223":["29a"]}}`;
}

let clue_ends = {};
const TILE_SIZE = 32;

function load() {
    return JSON.parse(JS);
}

let board = load();
for (let [num, info] of Object.entries(board.across)) {
    add_clue(num, info.clue, "across");
    let or = get_origin(`${num}a`);
    let x = or[0] + info.answer.length - 1;
    let y = or[1];
    clue_ends[`${num}a`] = `${y * board.size + x};${x};${y}`;
}

for (let [num, info] of Object.entries(board.down)) {
    add_clue(num, info.clue, "down");
    let or = get_origin(`${num}d`);
    let x = or[0];
    let y = or[1] + info.answer.length - 1;
    clue_ends[`${num}d`] = `${y * board.size + x};${x};${y}`;
}

function get_origin(clue) {
    let num = clue.slice(0, clue.length - 1);
    for (let number of Object.keys(board.numbers)) {
        if (board.numbers[number] == num) return [number % board.size, Math.floor(number / board.size)];
    }
}

function create_board() {
    function create_square(x, y) {
        let i = y * board.size + x;

        let num;
        if (board.numbers[i]) num = board.numbers[i];
        
        
        if (board.blank.includes(i)) {
            let el = document.createElement("div");
            el.className = "blank";
            el.style.left = `${(x + 1) * TILE_SIZE}px`;
            el.style.top = `${(y + 1) * TILE_SIZE}px`;
            document.body.appendChild(el);
        } else {
            if (num) {
                let n = document.createElement("p");
                n.className = "number";
                n.style.left = `${(x + 1) * TILE_SIZE}px`;
                n.style.top = `${(y + 1) * TILE_SIZE}px`;
                n.innerText = num;
                document.body.appendChild(n);
            }

            let el = document.createElement("div");
            el.className = "square";
            el.style.left = `${(x + 1) * TILE_SIZE}px`;
            el.style.top = `${(y + 1) * TILE_SIZE}px`;
            el.id = `${i};${x};${y}`;

            if (x == 0) el.classList.add("left_exposed");
            if (y == 0) el.classList.add("top_exposed");

            document.body.appendChild(el);
        }
    }

    for (y = 0; y < board.size; y++) {
        for (x = 0; x < board.size; x++) {
            create_square(x, y);
        }
    }
}

create_board();
main();

function add_clue(num, clue, dir) {
    let li = document.createElement("li");
    li.className = "clue";
    li.id = `${num}${dir.charAt(0)}`;
    li.innerText = `${num}: ${clue}`;
    li.onclick = ev => {
        let e = ev.target;
        let n = e.id.slice(0, e.id.length - 1);
        let d = e.id.charAt(e.id.length - 1);

        let dir = d == "d" ? "down" : "across";
        let [x, y] = get_origin(`${n}${d}`);

        selected = document.getElementById(`${y * board.size + x};${x};${y}`);
        selected_dir = d;
        update_selection();
    }
    
    document.getElementById(dir).appendChild(li);
}